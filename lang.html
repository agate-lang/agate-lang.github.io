<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.12">
<meta name="author" content="v0.1">
<title>The Agate Language</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="./rouge-old_github.css">
  <meta name="keywords" content="Agate, programming language, scripting, gamedev" />
  <meta name="description" content="Agate, a simple and embeddable programming language" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
</head>
<body class="article toc2 toc-right">
<div id="header">
<h1>The Agate Language</h1>
<div class="details">
<span id="author" class="author">v0.1</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_syntax">Syntax</a>
<ul class="sectlevel2">
<li><a href="#_comments">Comments</a></li>
<li><a href="#_keywords">Keywords</a></li>
<li><a href="#_identifiers">Identifiers</a></li>
<li><a href="#_newlines">Newlines</a></li>
<li><a href="#_blocks">Blocks</a></li>
</ul>
</li>
<li><a href="#_values">Values</a>
<ul class="sectlevel2">
<li><a href="#_nil">Nil</a></li>
<li><a href="#_boolean">Boolean</a></li>
<li><a href="#_integers">Integers</a></li>
<li><a href="#_floats">Floats</a></li>
<li><a href="#_characters">Characters</a></li>
<li><a href="#_strings">Strings</a></li>
<li><a href="#_ranges">Ranges</a></li>
</ul>
</li>
<li><a href="#_expressions">Expressions</a>
<ul class="sectlevel2">
<li><a href="#_array_literals">Array Literals</a></li>
<li><a href="#_map_literals">Map Literals</a></li>
<li><a href="#_tuple_literals">Tuple Literals</a></li>
<li><a href="#_operators">Operators</a></li>
<li><a href="#_the_truth_is_out_there">The truth is out there</a></li>
<li><a href="#_logical_operators">Logical Operators</a></li>
</ul>
</li>
<li><a href="#_control_flow">Control Flow</a>
<ul class="sectlevel2">
<li><a href="#_if_statements">If Statements</a></li>
<li><a href="#_once_statements">Once Statements</a></li>
<li><a href="#_loop_statements">Loop Statements</a></li>
<li><a href="#_while_statements">While Statements</a></li>
<li><a href="#_for_statements">For Statements</a></li>
<li><a href="#_iterator_protocol">Iterator Protocol</a></li>
<li><a href="#_interrupting_a_loop">Interrupting a Loop</a></li>
<li><a href="#_assert_statements">Assert Statements</a></li>
</ul>
</li>
<li><a href="#_variables">Variables</a>
<ul class="sectlevel2">
<li><a href="#_definition">Definition</a></li>
<li><a href="#_assignment">Assignment</a></li>
<li><a href="#_scope">Scope</a></li>
</ul>
</li>
<li><a href="#_classes">Classes</a>
<ul class="sectlevel2">
<li><a href="#_methods">Methods</a></li>
<li><a href="#_constructor">Constructor</a></li>
<li><a href="#_static_methods">Static methods</a></li>
<li><a href="#_fields">Fields</a></li>
<li><a href="#_this"><code>this</code></a></li>
<li><a href="#_inheritance">Inheritance</a></li>
<li><a href="#_mixin">Mixin</a></li>
</ul>
</li>
<li><a href="#_functions">Functions</a>
<ul class="sectlevel2">
<li><a href="#_definition_parameters_and_return_value">Definition, parameters and return value</a></li>
<li><a href="#_call">Call</a></li>
<li><a href="#_block_argument">Block Argument</a></li>
<li><a href="#_closure">Closure</a></li>
<li><a href="#_callable">Callable</a></li>
</ul>
</li>
<li><a href="#_units">Units</a>
<ul class="sectlevel2">
<li><a href="#_import">Import</a></li>
<li><a href="#_process">Process</a></li>
<li><a href="#_location">Location</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The Agate language is a scripting language.</p>
</div>
<div class="paragraph">
<p><a href="index.html">&lt; Back to main page</a></p>
</div>
<div class="paragraph">
<p>An Agate file is a UTF-8 plain text file with a <code>.agate</code> extension.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_syntax"><a class="anchor" href="#_syntax"></a>Syntax</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The syntax of Agate is inspired by C, but also takes ideas from Ruby and other languages.</p>
</div>
<div class="sect2">
<h3 id="_comments"><a class="anchor" href="#_comments"></a>Comments</h3>
<div class="paragraph">
<p>Comments starts with <code>#</code> and run until the end of the line.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="c1"># comments are useful for</span><span class="err">
</span><span class="c1"># programmers, do comment your</span><span class="err">
</span><span class="c1"># source code!</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In particular, it&#8217;s possible to put a <a href="https://en.wikipedia.org/wiki/Shebang_(Unix)">shebang</a> at the beginning of the file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="c1">#!/usr/local/bin/agate-cli</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>There is no multi-line comments in Agate.</p>
</div>
</div>
<div class="sect2">
<h3 id="_keywords"><a class="anchor" href="#_keywords"></a>Keywords</h3>
<div class="paragraph">
<p>Agate has <strong>25</strong> keywords: <code>as</code>, <code>assert</code>, <code>break</code>, <code>class</code>, <code>construct</code>, <code>continue</code>, <code>def</code>, <code>else</code>, <code>false</code>, <code>for</code>, <code>foreign</code>, <code>if</code>, <code>import</code>, <code>in</code>, <code>is</code>, <code>loop</code>, <code>mixin</code>, <code>nil</code>, <code>once</code>, <code>return</code>, <code>static</code>, <code>super</code>, <code>this</code>, <code>true</code>, <code>while</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_identifiers"><a class="anchor" href="#_identifiers"></a>Identifiers</h3>
<div class="paragraph">
<p>Agate identifiers follow the same rules as the C identifiers. An idenfitier must start with a letter or <code>_</code>, and then may contain letters, digits or <code>_</code>. Identifiers are case-sensitive. Identifiers must not be keywords.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="n">variable_name</span><span class="err">
</span><span class="n">ClassName</span><span class="err">
</span><span class="n">__private_name</span><span class="err">
</span><span class="n">CONSTANT_NAME</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_newlines"><a class="anchor" href="#_newlines"></a>Newlines</h3>
<div class="paragraph">
<p>Newlines are meaningfull in Agate. They mark the end of a statement. Each statement or expression must be on a single line. If the statement seems too long to be on a single line, it&#8217;s probably because you should refactor your code in order to make it more readable.</p>
</div>
</div>
<div class="sect2">
<h3 id="_blocks"><a class="anchor" href="#_blocks"></a>Blocks</h3>
<div class="paragraph">
<p>Blocks are surrounded by <code>{</code> and <code>}</code>. Blocks are used in <a href="#_control_flow">Control Flow</a> and  <a href="#_functions">Functions</a>. They are two kinds of blocks: expression blocks and statement blocks.</p>
</div>
<div class="paragraph">
<p>An expression block is a block with no newline after the opening <code>{</code> and consisting in a single expression, followed by the closing <code>}</code> on the same line. An expression block evaluates to the expression that is inside the block.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="p">{</span><span class="w"> </span><span class="s">"expression"</span><span class="w"> </span><span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s useful in the case of simple functions or methods that can be written as a single expression. In this case, it&#8217;s equivalent to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="s">"expression"</span><span class="err">
</span><span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A statement block is a block with a newline after the opening <code>{</code> followed by statements, and a closing <code>}</code> on its own line.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"The cake"</span><span class="p">)</span><span class="err">
</span><span class="w">  </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"is"</span><span class="p">)</span><span class="err">
</span><span class="w">  </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"a lie"</span><span class="p">)</span><span class="err">
</span><span class="p">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_values"><a class="anchor" href="#_values"></a>Values</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Values are immutable built-in objects of the language.</p>
</div>
<div class="sect2">
<h3 id="_nil"><a class="anchor" href="#_nil"></a>Nil</h3>
<div class="paragraph">
<p><code>nil</code> represents the absence of value, it is the only instance of the <a href="Nil.html"><code>Nil</code></a> class. It is similar to <code>nullptr</code> in C++.</p>
</div>
</div>
<div class="sect2">
<h3 id="_boolean"><a class="anchor" href="#_boolean"></a>Boolean</h3>
<div class="paragraph">
<p>A boolean value represents whether something is true or false. The literals <code>true</code> and <code>false</code> can be used to create the two possible boolean values. Their class is <a href="Bool.html"><code>Bool</code></a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_integers"><a class="anchor" href="#_integers"></a>Integers</h3>
<div class="paragraph">
<p>An <a href="https://en.wikipedia.org/wiki/Integer_(computer_science)">integer</a> is a 64-bit signed number.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="mi">12345</span><span class="w">      </span><span class="c1"># decimal form</span><span class="err">
</span><span class="mh">0xDeadBeef</span><span class="w"> </span><span class="c1"># hexadecimal form</span><span class="err">
</span><span class="mo">0o755</span><span class="w">      </span><span class="c1"># octal form</span><span class="err">
</span><span class="mb">0b101010</span><span class="w">   </span><span class="c1"># binary form</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Integers are instances of the <a href="Int.html"><code>Int</code></a> class.</p>
</div>
</div>
<div class="sect2">
<h3 id="_floats"><a class="anchor" href="#_floats"></a>Floats</h3>
<div class="paragraph">
<p>A <a href="https://en.wikipedia.org/wiki/Double-precision_floating-point_format">float</a> is a double precision floating-point number. In order to be recognized as floats, float literals must have a decimal part starting with a point <code>.</code> and at least one digit after the point, or an exponent part starting with <code>e</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="mi">3</span><span class="p">.</span><span class="mi">141592</span><span class="err">
</span><span class="mi">42</span><span class="p">.</span><span class="mi">0</span><span class="err">
</span><span class="mi">1</span><span class="n">e10</span><span class="err">
</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="n">e</span><span class="o">-</span><span class="mi">5</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Floats are instances of the <a href="Float.html"><code>Float</code></a> class.</p>
</div>
</div>
<div class="sect2">
<h3 id="_characters"><a class="anchor" href="#_characters"></a>Characters</h3>
<div class="paragraph">
<p>A character is a single UTF-32 encoded codepoint. A character is surrounded by single quotes <code>'</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="sc">'a'</span><span class="err">
</span><span class="sc">'æœ¨'</span><span class="err">
</span><span class="sc">'ðŸŽ®'</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Characters are instances of the <a href="Char.html"><code>Char</code></a> class.</p>
</div>
<div class="sect3">
<h4 id="_escape_sequences"><a class="anchor" href="#_escape_sequences"></a>Escape Sequences</h4>
<div class="paragraph">
<p>Usual escape sequences are available.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="sc">'\0'</span><span class="w"> </span><span class="c1"># U+0000 NULL</span><span class="err">
</span><span class="sc">'\a'</span><span class="w"> </span><span class="c1"># U+0007 BELL</span><span class="err">
</span><span class="sc">'\b'</span><span class="w"> </span><span class="c1"># U+0008 BACKSPACE</span><span class="err">
</span><span class="sc">'\t'</span><span class="w"> </span><span class="c1"># U+0009 CHARACTER TABULATION (horizontal tabulation)</span><span class="err">
</span><span class="sc">'\n'</span><span class="w"> </span><span class="c1"># U+000A LINE FEED (new line)</span><span class="err">
</span><span class="sc">'\v'</span><span class="w"> </span><span class="c1"># U+000B LINE TABULATION (vertical tabulation)</span><span class="err">
</span><span class="sc">'\f'</span><span class="w"> </span><span class="c1"># U+000C FORM FEED</span><span class="err">
</span><span class="sc">'\r'</span><span class="w"> </span><span class="c1"># U+000D CARRIAGE RETURN</span><span class="err">
</span><span class="sc">'\e'</span><span class="w"> </span><span class="c1"># U+001B ESCAPE</span><span class="err">
</span><span class="sc">'\"'</span><span class="w"> </span><span class="c1"># U+0022 QUOTATION MARK (double quote)</span><span class="err">
</span><span class="sc">'\%'</span><span class="w"> </span><span class="c1"># U+0025 PERCENT SIGN</span><span class="err">
</span><span class="sc">'\''</span><span class="w"> </span><span class="c1"># U+0027 APOSTROPHE (single quote)</span><span class="err">
</span><span class="sc">'\\'</span><span class="w"> </span><span class="c1"># U+005C REVERSE SOLIDUS (backslash)</span><span class="err">

</span><span class="sc">'\u6728'</span><span class="w">     </span><span class="c1"># 'æœ¨'</span><span class="err">
</span><span class="sc">'\U0001F3AE'</span><span class="w"> </span><span class="c1"># 'ðŸŽ®'</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_strings"><a class="anchor" href="#_strings"></a>Strings</h3>
<div class="paragraph">
<p>A string is a sequence of Unicode codepoints. They are stored using UTF-8 encoding. A string literal is surrounded by double quotes <code>"</code>. Escape sequences can also be used in strings.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="s">""</span><span class="w"> </span><span class="c1"># empty string</span><span class="err">
</span><span class="s">"The cake is a lie"</span><span class="err">
</span><span class="s">"I love </span><span class="se">\U</span><span class="s">0001F3AE"</span><span class="w"> </span><span class="c1"># I love ðŸŽ®</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Strings are instances of the <a href="String.html"><code>String</code></a> class.</p>
</div>
<div class="sect3">
<h4 id="_interpolation"><a class="anchor" href="#_interpolation"></a>Interpolation</h4>
<div class="paragraph">
<p>Interpolation in strings is introduced by <code>%</code> followed by a parenthesized expression. The expression is evaluated and the <code>.to_s</code> method is called on the result and inserted in the string. Interpolations can be nested.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"The answer is </span><span class="si">%(</span><span class="mi">6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">7</span><span class="si">)</span><span class="s">"</span><span class="p">)</span><span class="w"> </span><span class="c1">#&gt; The answer is 42</span><span class="err">
</span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"The answer is </span><span class="si">%(</span><span class="p">(</span><span class="mi">2</span><span class="p">..</span><span class="mi">1</span><span class="p">).</span><span class="n">map</span><span class="w"> </span><span class="p">{</span><span class="o">|</span><span class="n">n</span><span class="o">|</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span><span class="p">}.</span><span class="n">join</span><span class="p">()</span><span class="si">)</span><span class="s">"</span><span class="p">)</span><span class="w"> </span><span class="c1">#&gt; The answer is 42</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ranges"><a class="anchor" href="#_ranges"></a>Ranges</h3>
<div class="paragraph">
<p>A range is a value that represents an interval of integers. A range can be constructed either with the <code>..</code> operator for inclusive range, or with the <code>...</code> operator for exclusive range. Ranges are used for <a href="#_for_statements">iterating</a> over a sequence of numbers, or for <a href="Array.html#_subscript_getter">array indexing</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="mi">2</span><span class="p">..</span><span class="mi">4</span><span class="w"> </span><span class="c1"># 2 to 4 (included)</span><span class="err">
</span><span class="mi">6</span><span class="p">...</span><span class="mi">9</span><span class="w"> </span><span class="c1"># 6 to 9 (excluded)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Ranges are instances of the <a href="Range.html"><code>Range</code></a> class.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_expressions"><a class="anchor" href="#_expressions"></a>Expressions</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_array_literals"><a class="anchor" href="#_array_literals"></a>Array Literals</h3>
<div class="paragraph">
<p>An array is a growable sequence of contiguous elements, also called <a href="https://en.wikipedia.org/wiki/Dynamic_array">dynamic array</a>. Arrays are instances of the <a href="Array.html"><code>Array</code></a> class. An array can contain any number of elements of any type. In Agate, array indexing is zero-based.</p>
</div>
<div class="paragraph">
<p>An array literal can be created with elements between <code>[</code> and <code>]</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="p">[</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="sc">'a'</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">14</span><span class="p">,</span><span class="w"> </span><span class="s">"good"</span><span class="p">,</span><span class="w"> </span><span class="k">true</span><span class="w"> </span><span class="p">]</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_map_literals"><a class="anchor" href="#_map_literals"></a>Map Literals</h3>
<div class="paragraph">
<p>A map is a sequence of key-value pairs, also called <a href="https://en.wikipedia.org/wiki/Associative_array">associative array</a>. Maps are instances of the <a href="Map.html"><code>Map</code></a> class. A map can contain any number of key-value pairs. Keys must implement a <code>.hash</code> method and preferably are not mutable.</p>
</div>
<div class="paragraph">
<p>A map literal can be created with key-value pairs between <code>{</code> and <code>}</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="p">{</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="sc">'a'</span><span class="p">,</span><span class="w"> </span><span class="k">true</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">14</span><span class="p">,</span><span class="w"> </span><span class="s">"good"</span><span class="o">:</span><span class="w"> </span><span class="k">nil</span><span class="w"> </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_tuple_literals"><a class="anchor" href="#_tuple_literals"></a>Tuple Literals</h3>
<div class="paragraph">
<p>A tuple is an immutable sequence of contiguous components, also called <a href="https://en.wikipedia.org/wiki/Product_type">product type</a>. Tuples are instances of the <a href="Tuple.html"><code>Tuple</code></a> class. A tuple can contain two or more components of any type. Like array, tuple indexing is zero-based.</p>
</div>
<div class="paragraph">
<p>A tuple literal can be created with components between <code>(</code> and <code>)</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="sc">'a'</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">14</span><span class="p">,</span><span class="w"> </span><span class="s">"good"</span><span class="p">,</span><span class="w"> </span><span class="k">true</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_operators"><a class="anchor" href="#_operators"></a>Operators</h3>
<div class="paragraph">
<p>The following table shows the precedence and associativity of the different operators in Agate. Note that, compared to C, the bitwise operators do not have the same precedence.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Operators precedence and associativity</caption>
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 57.1428%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Precedence</th>
<th class="tableblock halign-left valign-top">Operators</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Associativity</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>()</code> <code>[]</code> <code>.</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Call, subscript, method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Left</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>+</code>, <code>-</code>, <code>!</code>, <code>~</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unary plus and minus, logical NOT, bitwise NOT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Right</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*</code>, <code>/</code>, <code>%</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multiplication, division, and remainder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Left</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>+</code>, <code>-</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Addition and subtraction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Left</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>..</code>, <code>...</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inclusive and exclusive range</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Left</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;&lt;</code>, <code>&gt;&gt;</code>, <code>&gt;&gt;&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arithmetic left shift, arithmetic right shift, logical right shift</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Left</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bitwise AND</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Left</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bitwise XOR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Left</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>|</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bitwise OR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Left</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>&lt;=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comparison operators</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Left</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>is</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type test</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Left</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>==</code>, <code>!=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Equality, inequality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Left</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;&amp;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logical AND</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Left</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>||</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logical OR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Left</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">15</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>?:</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Conditional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Right</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assignment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Right</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_the_truth_is_out_there"><a class="anchor" href="#_the_truth_is_out_there"></a>The truth is out there</h3>
<div class="paragraph">
<p>In the context of control flow, any expression can be evaluated as a condition. Thus, it is necessary to split the expressions between those that are true and those that are false:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>false</code> and <code>nil</code> are false</p>
</li>
<li>
<p>everything else is true</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In particular, <code>0</code> is true whereas it is false in C/C++.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">false</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"This is true"</span><span class="p">)</span><span class="w"> </span><span class="c1">#&gt; This is true</span><span class="err">
</span><span class="p">}</span><span class="err">
</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"This is also true"</span><span class="p">)</span><span class="w"> </span><span class="c1">#&gt; This is also true</span><span class="err">
</span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_logical_operators"><a class="anchor" href="#_logical_operators"></a>Logical Operators</h3>
<div class="paragraph">
<p>Logical operators <code>&amp;&amp;</code> and <code>||</code> do <a href="https://en.wikipedia.org/wiki/Short-circuit_evaluation">short-circuit evaluation</a>: the second argument is evaluated only if the first argument is not enough to determine the value of the expression.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_control_flow"><a class="anchor" href="#_control_flow"></a>Control Flow</h2>
<div class="sectionbody">
<div class="paragraph">
<p>All control flow statements in Agate follow the same principles:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the condition is between brackets i.e. <code>(</code> and <code>)</code> are mandatory</p>
</li>
<li>
<p>the statements are statement blocks i.e. <code>{</code> and <code>}</code> are mandatory</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_if_statements"><a class="anchor" href="#_if_statements"></a>If Statements</h3>
<div class="paragraph">
<p>The <code>if</code> statement is a <a href="https://en.wikipedia.org/wiki/Conditional_(computer_programming)">conditional statement</a>.  The <code>else</code> branch is optional. An <code>else</code> branch may be either a statement block or another <code>if</code> statement.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">def</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">42</span><span class="err">
</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"</span><span class="si">%(</span><span class="n">x</span><span class="si">)</span><span class="s"> is even"</span><span class="p">)</span><span class="w"> </span><span class="c1">#&gt; 42 is even</span><span class="err">
</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"</span><span class="si">%(</span><span class="n">x</span><span class="si">)</span><span class="s"> is odd"</span><span class="p">)</span><span class="err">
</span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_once_statements"><a class="anchor" href="#_once_statements"></a>Once Statements</h3>
<div class="paragraph">
<p>The <code>once</code> statement is a degenerate loop statement where the loop is executed exactly once. It is an idiomatic way to create a new scope, with the additional property that it is a loop like any other, so it can be interrupted.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">once</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Hello"</span><span class="p">)</span><span class="w"> </span><span class="c1">#&gt; Hello</span><span class="err">
</span><span class="w">  </span><span class="k">break</span><span class="err">
</span><span class="w">  </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"World"</span><span class="p">)</span><span class="err">
</span><span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>See also: <a href="#_interrupting_a_loop">Interrupting a Loop</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_loop_statements"><a class="anchor" href="#_loop_statements"></a>Loop Statements</h3>
<div class="paragraph">
<p>The <code>loop</code> statement creates an <a href="https://en.wikipedia.org/wiki/Infinite_loop">infinite loop</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">def</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="err">
</span><span class="k">loop</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="err">
</span><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">    </span><span class="k">break</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="err">
</span><span class="w">  </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="err">
</span><span class="p">}</span><span class="err">
</span><span class="c1">#&gt; 1</span><span class="err">
</span><span class="c1">#&gt; 2</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>See also: <a href="#_interrupting_a_loop">Interrupting a Loop</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_while_statements"><a class="anchor" href="#_while_statements"></a>While Statements</h3>
<div class="paragraph">
<p>The <code>while</code> statement is a <a href="https://en.wikipedia.org/wiki/While_loop">loop statement</a> that allows to loop over statements while a condition is true.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">def</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">27</span><span class="err">
</span><span class="k">def</span><span class="w"> </span><span class="n">steps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="err">
</span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">    </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">    </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="err">
</span><span class="w">  </span><span class="n">steps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">steps</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="err">
</span><span class="p">}</span><span class="err">
</span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span><span class="w"> </span><span class="c1">#&gt; 111</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>See also: <a href="#_interrupting_a_loop">Interrupting a Loop</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_for_statements"><a class="anchor" href="#_for_statements"></a>For Statements</h3>
<div class="paragraph">
<p>The <code>for</code> statement is a <a href="https://en.wikipedia.org/wiki/Foreach_loop">loop statement</a> that allows to loop over a sequence. It has three components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a variable name to bind, a new variable with that name with the loop scope is created</p>
</li>
<li>
<p>a sequence to iterate that is evaluated once before the loop starts</p>
</li>
<li>
<p>a body that is a statement block</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">direction</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s">"north"</span><span class="p">,</span><span class="w"> </span><span class="s">"east"</span><span class="p">,</span><span class="w"> </span><span class="s">"south"</span><span class="p">,</span><span class="w"> </span><span class="s">"west"</span><span class="w"> </span><span class="p">])</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span><span class="err">
</span><span class="p">}</span><span class="err">
</span><span class="c1">#&gt; north</span><span class="err">
</span><span class="c1">#&gt; east</span><span class="err">
</span><span class="c1">#&gt; south</span><span class="err">
</span><span class="c1">#&gt; west</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The sequence can be an <a href="Array.html"><code>Array</code></a>, a <a href="Range.html"><code>Range</code></a>, a <a href="Map.html"><code>Map</code></a>, a <a href="String.html"><code>String</code></a> or any other object that implements the iterator protocol.</p>
</div>
<div class="paragraph">
<p>See also: <a href="#_interrupting_a_loop">Interrupting a Loop</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_iterator_protocol"><a class="anchor" href="#_iterator_protocol"></a>Iterator Protocol</h3>
<div class="paragraph">
<p>The iterator protocol is the protocol used by <code>for</code> statements. A sequence used in a for statement must implement two functions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>iterate(iterator)</code>: it takes an iterator or <code>nil</code> at the first iteration and returns an iterator to the next item of the sequence or <code>nil</code> if the sequence is finished.</p>
</li>
<li>
<p><code>iterator_value(iterator)</code>: it takes an iterator and returns the value of the item in the sequence that is pointed by the iterator.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The iterator can be any type.</p>
</div>
<div class="paragraph">
<p>Then the following statement:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">variable</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">sequence</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="n">statements</span><span class="err">
</span><span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>is translated to the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">def</span><span class="w"> </span><span class="vm">$sequence</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sequence</span><span class="err">
</span><span class="k">def</span><span class="w"> </span><span class="vm">$iterator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nil</span><span class="err">
</span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="vm">$iterator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vm">$sequence</span><span class="p">.</span><span class="n">iterate</span><span class="p">(</span><span class="vm">$iterator</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vm">$sequence</span><span class="p">.</span><span class="n">iterator_value</span><span class="p">(</span><span class="vm">$iterator</span><span class="p">)</span><span class="err">
</span><span class="w">  </span><span class="n">statements</span><span class="err">
</span><span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>$sequence</code> and <code>$iterator</code> are internal variables that you cannot use directly.</p>
</div>
</div>
<div class="sect2">
<h3 id="_interrupting_a_loop"><a class="anchor" href="#_interrupting_a_loop"></a>Interrupting a Loop</h3>
<div class="paragraph">
<p>There are two statements to interrupt a loop.</p>
</div>
<div class="paragraph">
<p>The <code>break</code> statement exits the loop early.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">])</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w">   </span><span class="c1">#&gt; 1</span><span class="err">
</span><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">   </span><span class="c1">#&gt; 2</span><span class="err">
</span><span class="w">    </span><span class="k">break</span><span class="w">         </span><span class="c1">#&gt; 3</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="err">
</span><span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>continue</code> statement jumps to the next iteration of the loop.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">])</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">   </span><span class="c1">#&gt; 1</span><span class="err">
</span><span class="w">    </span><span class="k">continue</span><span class="w">      </span><span class="c1">#&gt; 3</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="w">               </span><span class="c1">#&gt; 4</span><span class="err">
</span><span class="w">  </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="err">
</span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_assert_statements"><a class="anchor" href="#_assert_statements"></a>Assert Statements</h3>
<div class="paragraph">
<p>The <code>assert</code> statement is useful for defensive programming. <a href="https://en.wikipedia.org/wiki/Assertion_(software_development)">Assertions</a> can prevent programming errors. In Agate, there are composed of a conditional expression that must be satisfied, and a string explaining the error in case the expression is false. The expression is verified and if false, the message is printed and the script stops with a runtime error.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">def</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="err">
</span><span class="k">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nc">Int</span><span class="p">,</span><span class="w"> </span><span class="s">"</span><span class="si">%(</span><span class="n">n</span><span class="si">)</span><span class="s"> should be an Int"</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_variables"><a class="anchor" href="#_variables"></a>Variables</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_definition"><a class="anchor" href="#_definition"></a>Definition</h3>
<div class="paragraph">
<p>New variables are created using the <code>def</code> keyword followed by the name of the variable. By default, they are initialized to <code>nil</code> unless they are explicitely initialized with <code>=</code> followed by an expression.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">def</span><span class="w"> </span><span class="n">anakin</span><span class="err">
</span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">anakin</span><span class="p">)</span><span class="w"> </span><span class="c1">#&gt; nil</span><span class="err">
</span><span class="k">def</span><span class="w"> </span><span class="n">luke</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">.</span><span class="mi">4</span><span class="err">
</span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">luke</span><span class="p">)</span><span class="w"> </span><span class="c1">#&gt; 5.4</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_assignment"><a class="anchor" href="#_assignment"></a>Assignment</h3>
<div class="paragraph">
<p>Variables can be assigned a new value with the <code>=</code> operator. The <code>=</code> operator is right associative. An assignment is an expression whose value is the result of the right side of <code>=</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">def</span><span class="w"> </span><span class="n">a</span><span class="err">
</span><span class="k">def</span><span class="w"> </span><span class="n">b</span><span class="err">
</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">42</span><span class="err">
</span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="c1">#&gt; 42</span><span class="err">
</span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">69</span><span class="err">
</span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="c1">#&gt; 69</span><span class="err">
</span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="c1">#&gt; 69</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_scope"><a class="anchor" href="#_scope"></a>Scope</h3>
<div class="paragraph">
<p>A variable life starts at its definition and ends when exiting the scope where it is defined. It is not possible to use a variable outside its lifetime. It is an error to define a variable with the same name in the same scope. It is possible to define a variable in an inner scope, this is called <a href="https://en.wikipedia.org/wiki/Variable_shadowing">variable shadowing</a> and it is strongly discouraged.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">def</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">42</span><span class="err">
</span><span class="k">once</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">69</span><span class="err">
</span><span class="w">  </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="c1">#&gt; 69</span><span class="err">
</span><span class="p">}</span><span class="err">
</span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="c1">#&gt; 42</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_classes"><a class="anchor" href="#_classes"></a>Classes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Every value is an object, and every object is an instance of a class. For example, <code>true</code> and <code>false</code> are instances of the <a href="Bool.html"><code>Bool</code></a> class.</p>
</div>
<div class="paragraph">
<p>New classes can be created with the <code>class</code> keyword.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">class</span><span class="w"> </span><span class="n">Entity</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="p">}</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_methods"><a class="anchor" href="#_methods"></a>Methods</h3>
<div class="paragraph">
<p><a href="https://en.wikipedia.org/wiki/Method_(computer_programming)">Methods</a> describe the behaviour of the objects of a class. Methods are defined inside the class scope, they may have zero, one or more arguments.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">class</span><span class="w"> </span><span class="n">Entity</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="n">update</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">    </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Update the state of the entity"</span><span class="p">)</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="err">
</span><span class="w">  </span><span class="n">render</span><span class="p">(</span><span class="n">target</span><span class="p">,</span><span class="w"> </span><span class="n">state</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">    </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Render to target using state"</span><span class="p">)</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="err">
</span><span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Several methods can have the same name as long as they do not have the same number of parameters. This means Agate support <a href="https://en.wikipedia.org/wiki/Function_overloading">overload</a> by arity. In fact, two different methods must have different <em>signatures</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">class</span><span class="w"> </span><span class="n">Entity</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="n">render</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">    </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Render to target using default state"</span><span class="p">)</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="err">
</span><span class="w">  </span><span class="n">render</span><span class="p">(</span><span class="n">target</span><span class="p">,</span><span class="w"> </span><span class="n">state</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">    </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Render to target using state"</span><span class="p">)</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="err">
</span><span class="p">}</span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_signature"><a class="anchor" href="#_signature"></a>Signature</h4>
<div class="paragraph">
<p>The signature of a method is composed of the name of the method with its parameters where the names of the parameters are replaced with <code>_</code>. For example, the signature of the <code>update</code> method in the example above is <code>update(_)</code>. The signatures of the <code>render</code> methods are <code>render(_)</code> and <code>render(_,_)</code>.</p>
</div>
<div class="paragraph">
<p>Signatures are at the heart of Agate method call, so it&#8217;s important to understand how they work.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Signatures of methods</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Signatures</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Simple method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name()</code>, <code>name(_)</code>, <code>name(_,_)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Getter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Setter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name=(_)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prefix operator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Infix operator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@(_)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Subscript getter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[_]</code>, <code>[_,_]</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Subscript Setter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[_]=(_)</code>, <code>[_,_]=(_)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Call operator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>()</code>, <code>(_)</code>, <code>(_,_)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Missing method operator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>?(_,_)</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_getter"><a class="anchor" href="#_getter"></a>Getter</h4>
<div class="paragraph">
<p>A getter is a method without any parameters, and no parentheses. Generally, they are used for getting properties of the object without modify the object, and are named with an adjective, contrary to zero-parameter methods that are verbs (and have parentheses) and modify the object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">class</span><span class="w"> </span><span class="n">Entity</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="n">alive</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">true</span><span class="w"> </span><span class="p">}</span><span class="err">
</span><span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The signature of a getter is just the name of the method. For example, <code>alive</code> is the signature of the method in the previous example.</p>
</div>
</div>
<div class="sect3">
<h4 id="_setter"><a class="anchor" href="#_setter"></a>Setter</h4>
<div class="paragraph">
<p>A setter is a method with a <code>=</code> after its name and exactly one parameter. They are used for setting properties of the object. They are called whenever there is an assignment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">class</span><span class="w"> </span><span class="n">Entity</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="k">construct</span><span class="w"> </span><span class="n">new</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="err">
</span><span class="w">  </span><span class="n">alive</span><span class="o">=</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">    </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"setter: </span><span class="si">%(</span><span class="n">value</span><span class="si">)</span><span class="s">"</span><span class="p">)</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="err">
</span><span class="p">}</span><span class="err">

</span><span class="k">def</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Entity</span><span class="p">.</span><span class="n">new</span><span class="p">()</span><span class="err">
</span><span class="n">a</span><span class="p">.</span><span class="n">alive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">false</span><span class="w"> </span><span class="c1">#&gt; setter: false</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The signature of a setter is the name of the method including the <code>=</code> followed by one parameter. For example, <code>alive=(_)</code> is the signature of the method in the previous example.</p>
</div>
</div>
<div class="sect3">
<h4 id="_operators_2"><a class="anchor" href="#_operators_2"></a>Operators</h4>
<div class="paragraph">
<p>Agate supports <a href="https://en.wikipedia.org/wiki/Operator_overloading">operator overloading</a> through operator methods. In fact, expressions with an operator are simply calls to operator methods, even for <a href="Int.html"><code>Int</code></a> or <a href="Float.html"><code>Float</code></a>!</p>
</div>
<div class="paragraph">
<p>A prefix operator method can be defined with the operator name as the method name, like a getter method. The list of the <strong>4</strong> overloadable prefix operators is: <code>+</code>, <code>-</code>, <code>!</code> and <code>~</code>. The signature of a prefix operator method is the name of the operator, e.g. <code>-</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">class</span><span class="w"> </span><span class="n">Vec</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="k">construct</span><span class="w"> </span><span class="n">new</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="err">
</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">    </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Negate a vector"</span><span class="p">)</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="err">
</span><span class="p">}</span><span class="err">
</span><span class="k">def</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vec</span><span class="p">.</span><span class="n">new</span><span class="p">()</span><span class="err">
</span><span class="k">def</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">a</span><span class="w"> </span><span class="c1">#&gt; Negate a vector</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>An infix operator method can be defined with the operator name followed by exactly one parameter as the method name. The list of the <strong>20</strong> overloadable infix operators is: <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code>, <code>&amp;</code>, <code>|</code>, <code>^</code>, <code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>&lt;&lt;</code>, <code>&gt;&gt;</code>, <code>&gt;&gt;&gt;</code>, <code>..</code>, <code>...</code>, <code>is</code>. The signature of an infix operator method is the name of the operator followed by one parameter, e.g. <code>+(_)</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">class</span><span class="w"> </span><span class="n">Vec</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="k">construct</span><span class="w"> </span><span class="n">new</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="err">
</span><span class="w">  </span><span class="o">+</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">    </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Add two vectors"</span><span class="p">)</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="err">
</span><span class="p">}</span><span class="err">
</span><span class="k">def</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vec</span><span class="p">.</span><span class="n">new</span><span class="p">()</span><span class="err">
</span><span class="k">def</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vec</span><span class="p">.</span><span class="n">new</span><span class="p">()</span><span class="err">
</span><span class="k">def</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="c1">#&gt; Add two vectors</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>..</code> and <code>...</code> are range operators and are implemented in <a href="Int.html"><code>Int</code></a> to create a <a href="Range.html"><code>Range</code></a>.</p>
</div>
<div class="paragraph">
<p><code>is</code> is the type test operator and is implementd in <a href="Object.html#_is"><code>Object</code></a> to test if an object is an instance of a given class. Overload this operator with caution!</p>
</div>
</div>
<div class="sect3">
<h4 id="_subscript"><a class="anchor" href="#_subscript"></a>Subscript</h4>
<div class="paragraph">
<p>It is possible to overload the subscript operator, both as a getter and a setter. The number of parameters inside the brackets is at least one.</p>
</div>
<div class="paragraph">
<p>The signature of a subscript getter method is <code>[_]</code>, <code>[_,_]</code>, &#8230;&#8203; according to the number of indices in the subscript.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">class</span><span class="w"> </span><span class="n">Matrix</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="k">construct</span><span class="w"> </span><span class="n">new</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="err">
</span><span class="w">  </span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">    </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Get element at </span><span class="si">%(</span><span class="n">x</span><span class="si">)</span><span class="s">,</span><span class="si">%(</span><span class="n">y</span><span class="si">)</span><span class="s">"</span><span class="p">)</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="err">
</span><span class="p">}</span><span class="err">

</span><span class="k">def</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Matrix</span><span class="p">.</span><span class="n">new</span><span class="p">()</span><span class="err">
</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="c1">#&gt; Get element at 1,2</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The signature of a subscript setter method is <code>[_]=(_)</code>, <code>[_,_]=(_)</code>, &#8230;&#8203; according to the number of indices in the subscript</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">class</span><span class="w"> </span><span class="n">Matrix</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="k">construct</span><span class="w"> </span><span class="n">new</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="err">
</span><span class="w">  </span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">    </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Set element at </span><span class="si">%(</span><span class="n">x</span><span class="si">)</span><span class="s">,</span><span class="si">%(</span><span class="n">y</span><span class="si">)</span><span class="s"> to </span><span class="si">%(</span><span class="n">value</span><span class="si">)</span><span class="s">"</span><span class="p">)</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="err">
</span><span class="p">}</span><span class="err">

</span><span class="k">def</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Matrix</span><span class="p">.</span><span class="n">new</span><span class="p">()</span><span class="err">
</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="c1">#&gt; Set element at 1,2 to 3</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_call_operator"><a class="anchor" href="#_call_operator"></a>Call Operator</h4>
<div class="paragraph">
<p>It is possible to overload the call operator. A class that overload the call operator is <a href="#_callable">callable</a>.</p>
</div>
<div class="paragraph">
<p>The signature of a call operator is <code>()</code>, <code>(_)</code>, <code>(_,_)</code>, &#8230;&#8203; according to the number of parameters in the call.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">class</span><span class="w"> </span><span class="n">Callable</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="k">construct</span><span class="w"> </span><span class="n">new</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="err">
</span><span class="w">  </span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">    </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Call with </span><span class="si">%(</span><span class="n">a</span><span class="si">)</span><span class="s">"</span><span class="p">)</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="err">
</span><span class="p">}</span><span class="err">

</span><span class="k">def</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Callable</span><span class="p">.</span><span class="n">new</span><span class="p">()</span><span class="err">
</span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="c1">#&gt; Call with 1</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_missing_method_operator"><a class="anchor" href="#_missing_method_operator"></a>Missing Method Operator</h4>
<div class="paragraph">
<p>It is possible to implement the missing method operator. In case a method is not found, then this special operator is called with the signature of the method and the arguments in an array. The signature of the missing method operator is <code>?(_,_)</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">class</span><span class="w"> </span><span class="n">Entity</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="k">construct</span><span class="w"> </span><span class="n">new</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="err">
</span><span class="w">  </span><span class="o">?</span><span class="p">(</span><span class="n">signature</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">    </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Method </span><span class="si">%(</span><span class="n">signature</span><span class="si">)</span><span class="s"> missing: </span><span class="si">%(</span><span class="n">args</span><span class="si">)</span><span class="s">"</span><span class="p">)</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="err">
</span><span class="p">}</span><span class="err">

</span><span class="k">def</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Entity</span><span class="p">.</span><span class="n">new</span><span class="p">()</span><span class="err">
</span><span class="n">e</span><span class="p">.</span><span class="n">unknown</span><span class="p">(</span><span class="s">"hello"</span><span class="p">)</span><span class="w"> </span><span class="c1">#&gt; Method unknown(_) missing: [hello]</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_constructor"><a class="anchor" href="#_constructor"></a>Constructor</h3>
<div class="paragraph">
<p>A constructor is a special method that create an instance of the object. It is introduced with a <code>construct</code> keyword. The method name must have parenthesized parameters and can have any name, even if, by convention, it is generally named <code>new()</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">class</span><span class="w"> </span><span class="n">Entity</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="k">construct</span><span class="w"> </span><span class="n">new</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">    </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Born to be alive"</span><span class="p">)</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="err">
</span><span class="p">}</span><span class="err">

</span><span class="k">def</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Entity</span><span class="p">.</span><span class="n">new</span><span class="p">()</span><span class="w"> </span><span class="c1">#&gt; Born to be alive</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As any other method, constructors can be overloaded by arity.</p>
</div>
<div class="paragraph">
<p>You can use <code>return</code> without any argument in a constructor, it&#8217;s an error to put an argument.</p>
</div>
</div>
<div class="sect2">
<h3 id="_static_methods"><a class="anchor" href="#_static_methods"></a>Static methods</h3>
<div class="paragraph">
<p>A static method is a method that do not apply to an instance of the class but to the class itself. As a class is an object itself, a static method is a method that applies to the class object. A static method is defined with the <code>static</code> keyword before the name of the method. A static method can be any kind of method.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">class</span><span class="w"> </span><span class="n">Entity</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="k">static</span><span class="w"> </span><span class="n">opening</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">    </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"All your base are belong to us"</span><span class="p">)</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="err">
</span><span class="p">}</span><span class="err">

</span><span class="n">Entity</span><span class="p">.</span><span class="n">opening</span><span class="p">()</span><span class="w"> </span><span class="c1">#&gt; All your base are belong to us</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_fields"><a class="anchor" href="#_fields"></a>Fields</h3>
<div class="paragraph">
<p>A <a href="https://en.wikipedia.org/wiki/Field_(computer_science)">field</a> stores the state of an object.</p>
</div>
<div class="paragraph">
<p>An <a href="https://en.wikipedia.org/wiki/Instance_variable">instance field</a>'s name starts with <code>@</code>. Contrary to variables, it does not need to be declared explicitely. It can only be used in instance methods. Initially, fields have a value of <code>nil</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">class</span><span class="w"> </span><span class="n">Entity</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="k">construct</span><span class="w"> </span><span class="n">new</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">    </span><span class="vc">@name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="err">
</span><span class="w">  </span><span class="n">name</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="vc">@name</span><span class="w"> </span><span class="p">}</span><span class="err">
</span><span class="p">}</span><span class="err">

</span><span class="k">def</span><span class="w"> </span><span class="n">hero</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Entity</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="s">"Mario"</span><span class="p">)</span><span class="err">
</span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">hero</span><span class="p">.</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="c1">#&gt; Mario</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A <a href="https://en.wikipedia.org/wiki/Class_variable">class field</a>'s name starts with <code>@@</code>. A static field is stored in the class itself, not in instances. It can be accessed through static and instance methods. Initially, static fields have a value of <code>nil</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">class</span><span class="w"> </span><span class="n">Entity</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="k">static</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="vi">@@count</span><span class="w"> </span><span class="p">}</span><span class="err">
</span><span class="w">  </span><span class="k">construct</span><span class="w"> </span><span class="n">new</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="vi">@@count</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nil</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">      </span><span class="vi">@@count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="err">
</span><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">      </span><span class="vi">@@count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vi">@@count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="err">
</span><span class="w">    </span><span class="p">}</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="err">
</span><span class="p">}</span><span class="err">

</span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">Entity</span><span class="p">.</span><span class="n">count</span><span class="p">)</span><span class="w"> </span><span class="c1">#&gt; nil</span><span class="err">
</span><span class="k">def</span><span class="w"> </span><span class="n">e1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Entity</span><span class="p">.</span><span class="n">new</span><span class="p">()</span><span class="err">
</span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">Entity</span><span class="p">.</span><span class="n">count</span><span class="p">)</span><span class="w"> </span><span class="c1">#&gt; 1</span><span class="err">
</span><span class="k">def</span><span class="w"> </span><span class="n">e2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Entity</span><span class="p">.</span><span class="n">new</span><span class="p">()</span><span class="err">
</span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">Entity</span><span class="p">.</span><span class="n">count</span><span class="p">)</span><span class="w"> </span><span class="c1">#&gt; 2</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Encapsulation is very strong in Agate. All fields are private and cannot be accessed from outside the class. You must provide a getter or a setter in order to provide an access to a field.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">class</span><span class="w"> </span><span class="n">Entity</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="n">health</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="vc">@health</span><span class="w"> </span><span class="p">}</span><span class="err">
</span><span class="w">  </span><span class="n">health</span><span class="o">=</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="vc">@health</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="p">}</span><span class="err">
</span><span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>An object can access its own instance fields and that&#8217;s all. This means an object cannot access another object&#8217;s fields, even if they have the same class. It cannot either access its base class fields.</p>
</div>
</div>
<div class="sect2">
<h3 id="_this"><a class="anchor" href="#_this"></a><code>this</code></h3>
<div class="paragraph">
<p><code>this</code> represent the object itself inside methods of the class. It can be used to refer to the current object, especially when calling another method of the class. You can even use <code>this</code> inside a function inside a method as <code>this</code> is in the closure of the function.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">class</span><span class="w"> </span><span class="n">Entity</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="k">construct</span><span class="w"> </span><span class="n">new</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="err">
</span><span class="w">  </span><span class="n">name</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">"Mario"</span><span class="w"> </span><span class="p">}</span><span class="err">
</span><span class="w">  </span><span class="n">name_twice</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">    </span><span class="p">(</span><span class="mi">1</span><span class="p">..</span><span class="mi">2</span><span class="p">).</span><span class="n">each</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">      </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">name</span><span class="p">)</span><span class="err">
</span><span class="w">    </span><span class="p">}</span><span class="err">
</span><span class="w">    </span><span class="c1">#&gt; Mario</span><span class="err">
</span><span class="w">    </span><span class="c1">#&gt; Mario</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="err">
</span><span class="p">}</span><span class="err">

</span><span class="k">def</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Entity</span><span class="p">.</span><span class="n">new</span><span class="p">()</span><span class="err">
</span><span class="n">e</span><span class="p">.</span><span class="n">name_twice</span><span class="p">()</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As it is verbose to put <code>this</code> every time you call another method, it can be omitted, but not the following <code>.</code>!</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">def</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"variable"</span><span class="err">

</span><span class="k">class</span><span class="w"> </span><span class="n">Entity</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="k">construct</span><span class="w"> </span><span class="n">new</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="err">
</span><span class="w">  </span><span class="n">name</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">"getter"</span><span class="w"> </span><span class="p">}</span><span class="err">
</span><span class="w">  </span><span class="n">who_am_i</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">    </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="w">      </span><span class="c1">#&gt; variable</span><span class="err">
</span><span class="w">    </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="c1">#&gt; getter</span><span class="err">
</span><span class="w">    </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(.</span><span class="n">name</span><span class="p">)</span><span class="w">     </span><span class="c1">#&gt; getter</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="err">
</span><span class="p">}</span><span class="err">

</span><span class="k">def</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Entity</span><span class="p">.</span><span class="n">new</span><span class="p">()</span><span class="err">
</span><span class="n">e</span><span class="p">.</span><span class="n">who_am_i</span><span class="p">()</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_inheritance"><a class="anchor" href="#_inheritance"></a>Inheritance</h3>
<div class="paragraph">
<p>A class can inherit another class, its superclass, using the <code>is</code> keyword. If a superclass is not present, the superclass is <a href="Object.html"><code>Object</code></a>. It&#8217;s not possible to inherit from builtin classes (<a href="Array.html"><code>Array</code></a>, <a href="Bool.html"><code>Bool</code></a>, <a href="Char.html"><code>Char</code></a>, <a href="Class.html"><code>Class</code></a>, <a href="Float.html"><code>Float</code></a>, <a href="Fn.html"><code>Fn</code></a>, <a href="Int.html"><code>Int</code></a>, <a href="Map.html"><code>Map</code></a>, <a href="Nil.html"><code>Nil</code></a>, <a href="Range.html"><code>Range</code></a>, <a href="String.html"><code>String</code></a>, <a href="String.html"><code>Tuple</code></a>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">class</span><span class="w"> </span><span class="n">Entity</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="c1"># no superclass = superclass is Object</span><span class="err">
</span><span class="p">}</span><span class="err">
</span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">Entity</span><span class="p">.</span><span class="n">supertype</span><span class="p">)</span><span class="w"> </span><span class="c1">#&gt; Object</span><span class="err">
</span><span class="k">class</span><span class="w"> </span><span class="n">Hero</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">Entity</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="c1"># superclass is Entity</span><span class="err">
</span><span class="p">}</span><span class="err">
</span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">Hero</span><span class="p">.</span><span class="n">supertype</span><span class="p">)</span><span class="w"> </span><span class="c1">#&gt; Entity</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>All instance methods are <a href="https://en.wikipedia.org/wiki/Dynamic_dispatch">dispatched dynamically</a>. Static methods are not inherited, as well as constructors.</p>
</div>
<div class="sect3">
<h4 id="_super"><a class="anchor" href="#_super"></a><code>super</code></h4>
<div class="paragraph">
<p><code>super</code> is used to access a method of the same name in the superclass. <code>super</code> can be used in constructors, in that case the name of the method is not necessary.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">class</span><span class="w"> </span><span class="n">Entity</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="k">construct</span><span class="w"> </span><span class="n">new</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">    </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Entity.new"</span><span class="p">)</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="err">
</span><span class="w">  </span><span class="n">print</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">    </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Entity.print"</span><span class="p">)</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="err">
</span><span class="p">}</span><span class="err">

</span><span class="k">class</span><span class="w"> </span><span class="n">Hero</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">Entity</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="k">construct</span><span class="w"> </span><span class="n">new</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">    </span><span class="k">super</span><span class="p">()</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="err">
</span><span class="w">  </span><span class="n">print</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">print</span><span class="p">()</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="err">
</span><span class="p">}</span><span class="err">

</span><span class="k">def</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Hero</span><span class="p">.</span><span class="n">new</span><span class="p">()</span><span class="w"> </span><span class="c1">#&gt; Entity.new</span><span class="err">
</span><span class="n">h</span><span class="p">.</span><span class="n">print</span><span class="p">()</span><span class="w"> </span><span class="c1">#&gt; Entity.print</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mixin"><a class="anchor" href="#_mixin"></a>Mixin</h3>
<div class="paragraph">
<p>A class can include the methods of another class with the <code>mixin</code> keyword. The included class must not have any fields and must not be a builtin class. It is also possible to do a static mixin to include the methods in the class itself rather than its instances.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">class</span><span class="w"> </span><span class="n">Representable</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="n">string</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">.</span><span class="n">to_s</span><span class="w"> </span><span class="p">}</span><span class="err">
</span><span class="p">}</span><span class="err">

</span><span class="k">class</span><span class="w"> </span><span class="n">Entity</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="k">mixin</span><span class="w"> </span><span class="n">Representable</span><span class="err">
</span><span class="w">  </span><span class="k">construct</span><span class="w"> </span><span class="n">new</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="err">
</span><span class="w">  </span><span class="n">to_s</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">"Entity"</span><span class="w"> </span><span class="p">}</span><span class="err">
</span><span class="p">}</span><span class="err">

</span><span class="k">def</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Entity</span><span class="p">.</span><span class="n">new</span><span class="p">()</span><span class="err">
</span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">string</span><span class="p">)</span><span class="w"> </span><span class="c1">#&gt; Entity</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>There may be several mixins. The order in which a mixin appear is important: its methods are included in the class at the point where it is declared. A method defined in a mixin may be overriden in the class if it appears after the mixin declaration.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_functions"><a class="anchor" href="#_functions"></a>Functions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A <a href="https://en.wikipedia.org/wiki/Subroutine">function</a> is a sequence of statements that may have some parameters. In Agate, functions are objects of class <a href="Fn.html"><code>Fn</code></a>.</p>
</div>
<div class="sect2">
<h3 id="_definition_parameters_and_return_value"><a class="anchor" href="#_definition_parameters_and_return_value"></a>Definition, parameters and return value</h3>
<div class="paragraph">
<p>The <code>def</code> keyword is used to create a new function. Contrary to methods, function can not be overloaded and must have a unique name. A function may have parameters, their names are between brackets after the function name. The function may return a value with the <code>return</code> keywork, or use an expression block. By default, <code>nil</code> is returned.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">def</span><span class="w"> </span><span class="n">is_even</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="err">
</span><span class="p">}</span><span class="err">

</span><span class="k">def</span><span class="w"> </span><span class="n">is_odd</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">!</span><span class="n">is_even</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, it is possible to create a function by creating an object of class <a href="Fn.html"><code>Fn</code></a>, thanks to a <a href="#_block_argument">block argument</a>. The result is exactly the same.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">def</span><span class="w"> </span><span class="n">is_even</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Fn</span><span class="p">.</span><span class="n">new</span><span class="w"> </span><span class="p">{</span><span class="o">|</span><span class="n">n</span><span class="o">|</span><span class="err">
</span><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="err">
</span><span class="p">}</span><span class="err">

</span><span class="k">def</span><span class="w"> </span><span class="n">is_odd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Fn</span><span class="p">.</span><span class="n">new</span><span class="w"> </span><span class="p">{</span><span class="o">|</span><span class="n">n</span><span class="o">|</span><span class="w"> </span><span class="o">!</span><span class="n">is_even</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_call"><a class="anchor" href="#_call"></a>Call</h3>
<div class="paragraph">
<p>A call to a function is just the function name followed by its arguments between brackets. The caller can use the return value of the function. If there are more arguments than parameters, the extra arguments are discarded.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">def</span><span class="w"> </span><span class="n">double</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">}</span><span class="err">

</span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">double</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="w">     </span><span class="c1">#&gt; 4</span><span class="err">
</span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">double</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">))</span><span class="w">  </span><span class="c1">#&gt; 4</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_block_argument"><a class="anchor" href="#_block_argument"></a>Block Argument</h3>
<div class="paragraph">
<p>If the last parameter is a function, the argument may be passed with a block argument. A block argument is a special block that can take parameters between <code>|</code> and act like a function. In fact, it is a function. It can be used to create callbacks.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">def</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">fn</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">fn</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="err">
</span><span class="p">}</span><span class="err">

</span><span class="k">def</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="n">str</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">str</span><span class="p">)</span><span class="err">
</span><span class="p">}</span><span class="err">

</span><span class="n">apply</span><span class="p">(</span><span class="s">"Hello"</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="o">|</span><span class="n">str</span><span class="o">|</span><span class="w"> </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">str</span><span class="p">)</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">#&gt; Hello</span><span class="err">
</span><span class="n">apply</span><span class="p">(</span><span class="s">"World"</span><span class="p">,</span><span class="w"> </span><span class="n">print</span><span class="p">)</span><span class="w"> </span><span class="c1">#&gt; World</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A block argument can also be used when calling methods.</p>
</div>
</div>
<div class="sect2">
<h3 id="_closure"><a class="anchor" href="#_closure"></a>Closure</h3>
<div class="paragraph">
<p>A function is a <a href="https://en.wikipedia.org/wiki/Closure_(computer_programming)">closure</a>, it can capture variables outside its scope.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">def</span><span class="w"> </span><span class="n">counter</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="err">
</span><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nc">Fn</span><span class="p">.</span><span class="n">new</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1"># i is captured</span><span class="err">
</span><span class="p">}</span><span class="err">

</span><span class="k">def</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">counter</span><span class="p">()</span><span class="err">
</span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">f</span><span class="p">())</span><span class="w"> </span><span class="c1">#&gt; 1</span><span class="err">
</span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">f</span><span class="p">())</span><span class="w"> </span><span class="c1">#&gt; 2</span><span class="err">
</span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">f</span><span class="p">())</span><span class="w"> </span><span class="c1">#&gt; 3</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_callable"><a class="anchor" href="#_callable"></a>Callable</h3>
<div class="paragraph">
<p>An object is callable if it implements the <a href="#_call_operator">call operator</a>. It acts like a function, but it is a method call.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">def</span><span class="w"> </span><span class="n">regular</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="err">
</span><span class="p">}</span><span class="err">

</span><span class="k">class</span><span class="w"> </span><span class="n">Callable</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="k">static</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">    </span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="err">
</span><span class="w">  </span><span class="p">}</span><span class="err">
</span><span class="p">}</span><span class="err">

</span><span class="k">def</span><span class="w"> </span><span class="n">invoke</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="w"> </span><span class="n">arg</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">fn</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span><span class="w"> </span><span class="p">}</span><span class="err">

</span><span class="n">invoke</span><span class="p">(</span><span class="n">regular</span><span class="p">,</span><span class="w"> </span><span class="s">"regular"</span><span class="p">)</span><span class="w">    </span><span class="c1">#&gt; regular</span><span class="err">
</span><span class="n">invoke</span><span class="p">(</span><span class="n">Callable</span><span class="p">,</span><span class="w"> </span><span class="s">"callable"</span><span class="p">)</span><span class="w">  </span><span class="c1">#&gt; callable</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_units"><a class="anchor" href="#_units"></a>Units</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A unit is a single Agate file that can be imported in another Agate file with the <code>import</code> keyword. Units are useful to break a big program into small (independent) pieces. Each unit has its own scope.</p>
</div>
<div class="sect2">
<h3 id="_import"><a class="anchor" href="#_import"></a>Import</h3>
<div class="paragraph">
<p>In order to import a unit, the keyword <code>import</code> is used, followed by a string that identifies the unit. Then, the top-level names from that unit are declared and copied from that unit into the current unit. The names can refer to variables, functions or classes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">import</span><span class="w"> </span><span class="s">"entities"</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Hero</span><span class="p">,</span><span class="w"> </span><span class="n">Villain</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>An <code>import</code> statement can be anywhere, not necessarily at the top of the file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">def</span><span class="w"> </span><span class="n">in_the_forest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="err">
</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">in_the_forest</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="err">
</span><span class="w">  </span><span class="k">import</span><span class="w"> </span><span class="s">"entities"</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Orc</span><span class="p">,</span><span class="w"> </span><span class="n">Troll</span><span class="err">
</span><span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can rename imported names using the <code>as</code> keyword. This is useful if two units export the same name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">import</span><span class="w"> </span><span class="s">"scenery"</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Tree</span><span class="err">
</span><span class="k">import</span><span class="w"> </span><span class="s">"entities"</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Tree</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">Ent</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_process"><a class="anchor" href="#_process"></a>Process</h3>
<div class="paragraph">
<p>During an import, the code in the unit is executed, pausing the current script. When the code in the import is finished, the script resumes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Before import"</span><span class="p">)</span><span class="w"> </span><span class="c1">#&gt; Before import</span><span class="err">
</span><span class="k">import</span><span class="w"> </span><span class="s">"tools"</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Debug</span><span class="w">    </span><span class="c1">#&gt; Tools are loaded</span><span class="err">
</span><span class="nc">IO</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"After import"</span><span class="p">)</span><span class="w">  </span><span class="c1">#&gt; After import</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A unit is never executed twice. It is only executed the first time it is imported, even when several units import the same unit.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="agate"><span class="k">import</span><span class="w"> </span><span class="s">"tools"</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Debug</span><span class="w">  </span><span class="c1">#&gt; Tools are loaded</span><span class="err">
</span><span class="k">import</span><span class="w"> </span><span class="s">"tools"</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Log</span><span class="w">    </span><span class="c1"># no output, the unit is alreay loaded</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This means you have to be very careful when doing cyclic imports!</p>
</div>
</div>
<div class="sect2">
<h3 id="_location"><a class="anchor" href="#_location"></a>Location</h3>
<div class="paragraph">
<p>The way to map the string after <code>import</code> to a file can be customized by the runtime environment (see <a href="embed.html#_units">Advanced Configuration - Units</a>). The convention is that the string <code>"foo/bar"</code> maps to a file called <code>foo/bar.agate</code> inside a root directory known by the runtime. The string is always relative to the root directory, not relative to the script directory.</p>
</div>
</div>
</div>
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains("stemblock")) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>